var DataTableOData;(function(n){function e(n,t,f){var e=i(f.nTable);e.getColumnsSettings(f);e.getColumns(n);e.Settings.queryOrder&&e.getOrder(n);$.ajax({url:e.query(!0,n),success:function(i){if(i)return f._iRecordsTotal=i["@odata.count"],e.Settings.useObjects?t(u(i,n.draw)):t(r(i,n.draw));return{error:"No return data from server"}},error:function(){return{draw:(new Date).getTime(),data:null,recordsFiltered:0,recordsTotal:0,error:"No return data from server"}}})}function i(t){typeof t!="object"&&(t=document.getElementById(t));for(var i=0,r=n.Instances.length;i<r;i++)if(n.Instances[i].Table.nTable==t)return n.Instances[i];return null}function r(n,t){var i={data:[],draw:t,recordsFiltered:Math.ceil(n["@odata.count"]/n.value.length),recordsTotal:n["@odata.count"]};return $.each(n.value,function(n,t){i.data.push($.map(t,function(n){return[n]}))}),i}function u(n,t){return{data:n.value,draw:t,recordsFiltered:n["@odata.count"],recordsTotal:n["@odata.count"]}}function o(n,t){var i="";switch(t){case"number":case"numeric":i=n;break;default:i="'"+n+"'"}return i.trim()}function s(t,i,r){var e=!1,u=[],f;return i.contains("and")?u=i.split("and"):i.contains("&&")?u=i.split("&&"):u.push(i),f=[],$.each(u,function(i,u){var o=u.trim();$.each(n.ODataComparisonOperatorsMap,function(t,i){o=o.replace(i,n.ODataComparisonOperators[t])});$.each(n.ODataComparisonOperators,function(i,u){if(o.contains(u+" ")){if(o=o.replace(u," "+u+" §"),o.indexOf("§")==o.lastIndexOf("§")){var s=o.split("§");o=s[0].trim()+" "+n.transformValue(s[1].trim(),r);f.push(t+" "+o)}e=!0}})}),e?" "+f.join(" and "):" eq "+t}var t=function(){function n(n){this.url="";typeof n=="string"&&(this.url=n||"");this.useObjects=!0;this.queryOrder=!0;this.querySelect=!0;this.pagingCache=1;this.searchColumns=!0;this.searchColumnsPlace="tfoot"}return n}(),f;n.Settings=t;n.Instances;n.CLASS="OData";n.VERSION="1.0";n.DEFAULTS=new t;n.ODataComparisonOperators=["eq","ne","gt","ge","lt","le","has"];n.ODataComparisonOperatorsMap=["==","!=",">",">=","<","<=","has"];n.ajaxFunction=e;n.getInstance=i;n.dataToArray=r;n.dataToObject=u;n.transformValue=o;n.transformSearch=s;f=function(){function i(n,i){this.Query="";this._columns=[];this._columnsSettings=[];this._search=[];this._order=[];this.Table=new $.fn.dataTable.Api(n).settings()[0];switch(typeof i){case"undefined":this.Table.oInit.odata!="undefined"?this.readSettings(this.Table.oInit.odata):this.Settings=null;break;case"string":this.Settings=new t(i);break;case"object":i!=null&&this.readSettings(i)}return this}return i.prototype.readSettings=function(t){this.Settings=n.DEFAULTS;typeof t=="object"&&t!=null&&(typeof t.url=="string"&&(this.Settings.url=t.url.trim()),typeof t.querySelect=="boolean"&&(this.Settings.querySelect=t.querySelect),typeof t.queryOrder=="boolean"&&(this.Settings.queryOrder=t.queryOrder),typeof t.useObjects=="boolean"&&(this.Settings.useObjects=t.useObjects),typeof t.searchColumns=="boolean"&&(this.Settings.searchColumns=t.searchColumns),typeof t.searchColumnsPlace=="string"&&(this.Settings.searchColumnsPlace=t.searchColumnsPlace))},i.prototype.searchColumnAddInputs=function(){if(this.Settings.searchColumns){var u=this,n=this.Table.nTable,t=this.Table.oLoadedState,i=new $.fn.dataTable.Api(this.Table.nTable),r=$("tfoot",n),f=$("thead tr:first th",n);this.Settings.searchColumnsPlace!=="tfoot"&&($("thead",n).append($("thead tr:first",n).clone().addClass("odata-search-column")),$("thead tr:first",n).css({"border-bottom-width":"0"}),$("thead tr:first th",n).css({"border-bottom-width":"0"}),r=$("thead tr.odata-search-column",n));$("th",r).each(function(n){if(u.Table.aoColumns[n].bSearchable){var e=f.eq(n).text(),r="";t&&t!=null&&(r=t.columns[n]!=null?t.columns[n].search.search:"");$(this).html('<input type="text" placeholder="'+e+'" value="'+r+'" />');$("input",this).change(function(){var t=$(this).val();t.length==0?i.column(n).search("").draw():t.length>=3&&i.column(n).search(t).draw()})}else $(this).html("")})}},i.prototype.getColumnsSettings=function(n){this._columns=[];var t=this;n.aoColumns.length>0&&$.each(n.aoColumns,function(n,i){var r=i.mData,u;r=="undefined"&&(r=i.sName);u={id:n,name:r,type:i.sType?i.sType:"string",order:"",searchMethod:i.searchMethod?i.searchMethod:"unset"};t._columnsSettings.push(u)})},i.prototype.getColumns=function(t){this._columns=[];this._search=[];var i=this;t.columns.length>0&&$.each(t.columns,function(t,r){var u="",f,e;parseInt(r.data.toString())==r.data?(u=r.name.trim(),i.Settings.useObjects=!1,i._columns.push(u)):(u=r.data.toString().trim(),i._columns.push(u));r.searchable&&r.search.value&&(f=i._columnsSettings[t],f.searchMethod=="unset"?(e=n.transformSearch(u,r.search.value,f.type),i._search.push(e.trim())):i._search.push(f.searchMethod+"("+u+","+n.transformValue(r.search.value,f.type)+")"))})},i.prototype.getOrder=function(n){this._order=[];var t=this;n.order.length>0&&$.each(n.order,function(i,r){t._order.push(n.columns[r.column].name+" "+r.dir.trim().toLowerCase())})},i.prototype.query=function(n,t){return n===void 0&&(n=!1),this.Query="$count=true&$format=json",this.Settings.querySelect&&(this.Query=this.Query+"&$select="+this._columns.join(",")),this.Settings.querySelect&&(this.Query=this.Query+"&$orderby="+this._order.join(",")),t!=null&&(this.Table.oInit.bServerSide&&(this.Query=this.Query+"&$top="+t.length*this.Settings.pagingCache+"&$skip="+t.start),this._search.length>0&&(this.Query=this.Query+"&$filter="+this._search.join(" and "))),(n?this.Settings.url+"?":"")+this.Query},i}();n.Init=f})(DataTableOData||(DataTableOData={})),function(){var n=function(n){"use strict";var t=function(n,t){if(typeof t!="undefined"){var i=new DataTableOData.Init(n,t);return DataTableOData.Instances||(DataTableOData.Instances=[]),DataTableOData.Instances.push(i),i.Settings!=null&&(n.ajax=DataTableOData.ajaxFunction),i}};return typeof n.fn.dataTable=="function"&&typeof n.fn.dataTable.versionCheck=="function"&&n.fn.dataTable.versionCheck("1.10.0")?n.fn.dataTable.ext.feature.push({fnInit:function(t){var i=t.oInit,r;i.odata&&i.odata!=null&&(r=n.fn.dataTable.OData(t,i.odata),r.searchColumnAddInputs());return},cFeature:"O",sFeature:"OData"}):alert("Warning: OData requires DataTables 1.10 or greater - www.datatables.net/download"),n.fn.dataTable.OData=t,n.fn.DataTable.OData=t,n.fn.dataTable.Api&&n.fn.dataTable.Api.register("odata()",function(){var n=null;return this.context.length>0&&(n=DataTableOData.getInstance(this.context[0].nTable)),n}),t};typeof define=="function"&&define.amd?define(["jquery","datatables"],n):typeof exports=="object"?n(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.OData&&n(jQuery,jQuery.fn.dataTable)}(window,document);
//# sourceMappingURL=dataTables.OData.min.js.map
